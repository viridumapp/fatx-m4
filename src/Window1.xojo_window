#tag DesktopWindow
Begin DesktopWindow Window1
   Backdrop        =   0
   BackgroundColor =   &cFFFFFF
   Composite       =   False
   DefaultLocation =   2
   FullScreen      =   False
   HasBackgroundColor=   False
   HasCloseButton  =   True
   HasFullScreenButton=   False
   HasMaximizeButton=   False
   HasMinimizeButton=   True
   HasTitleBar     =   True
   Height          =   540
   ImplicitInstance=   True
   MacProcID       =   0
   MaximumHeight   =   540
   MaximumWidth    =   800
   MenuBar         =   1403840511
   MenuBarVisible  =   False
   MinimumHeight   =   540
   MinimumWidth    =   675
   Resizeable      =   True
   Title           =   "Meal Planner"
   Type            =   0
   Visible         =   True
   Width           =   675
   Begin DesktopPopupMenu meal1_simple_popup
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   32
      Index           =   -2147483648
      InitialValue    =   ""
      Italic          =   False
      Left            =   95
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   0
      SelectedRowIndex=   -1
      TabIndex        =   1
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   "Simple Carbs"
      Top             =   145
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   190
   End
   Begin DesktopPopupMenu meal1_protein_popup
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   32
      Index           =   -2147483648
      InitialValue    =   ""
      Italic          =   False
      Left            =   95
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   0
      SelectedRowIndex=   -1
      TabIndex        =   2
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   "Protein"
      Top             =   185
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   190
   End
   Begin DesktopPopupMenu meal2_complex_popup
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   32
      Index           =   -2147483648
      InitialValue    =   ""
      Italic          =   False
      Left            =   95
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   0
      SelectedRowIndex=   -1
      TabIndex        =   3
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   "Complex Carbs"
      Top             =   235
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   190
   End
   Begin DesktopPopupMenu meal2_extra_popup
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   32
      Index           =   -2147483648
      InitialValue    =   ""
      Italic          =   False
      Left            =   95
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   0
      SelectedRowIndex=   -1
      TabIndex        =   4
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   "Extras"
      Top             =   275
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   190
   End
   Begin DesktopPopupMenu meal3_greens_popup
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   32
      Index           =   -2147483648
      InitialValue    =   ""
      Italic          =   False
      Left            =   95
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   0
      SelectedRowIndex=   -1
      TabIndex        =   5
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   "Green Carbs"
      Top             =   325
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   190
   End
   Begin DesktopPopupMenu meal3_fats_popup
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   32
      Index           =   -2147483648
      InitialValue    =   ""
      Italic          =   False
      Left            =   95
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   0
      SelectedRowIndex=   -1
      TabIndex        =   6
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   365
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   190
   End
   Begin DesktopLabel Label1
      AllowAutoDeactivate=   True
      Bold            =   True
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      Italic          =   False
      Left            =   24
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   6
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "MEAL 1 -"
      TextAlignment   =   0
      TextColor       =   &c000000
      Tooltip         =   ""
      Top             =   145
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   65
   End
   Begin DesktopLabel Label2
      AllowAutoDeactivate=   True
      Bold            =   True
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      Italic          =   False
      Left            =   24
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   7
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "MEAL 2 -"
      TextAlignment   =   0
      TextColor       =   &c000000
      Tooltip         =   ""
      Top             =   235
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   65
   End
   Begin DesktopLabel Label3
      AllowAutoDeactivate=   True
      Bold            =   True
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      Italic          =   False
      Left            =   24
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   8
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "MEAL 3 -"
      TextAlignment   =   0
      TextColor       =   &c000000
      Tooltip         =   ""
      Top             =   325
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   65
   End
   Begin DesktopTextField meal1_ready
      AllowAutoDeactivate=   True
      AllowFocusRing  =   True
      AllowSpellChecking=   False
      AllowTabs       =   False
      BackgroundColor =   &cEAEFEA00
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Format          =   ""
      HasBorder       =   True
      Height          =   32
      Hint            =   ""
      Index           =   -2147483648
      Italic          =   False
      Left            =   312
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      MaximumCharactersAllowed=   0
      Password        =   False
      ReadOnly        =   True
      Scope           =   0
      TabIndex        =   7
      TabPanelIndex   =   0
      TabStop         =   False
      Text            =   ""
      TextAlignment   =   0
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   185
      Transparent     =   False
      Underline       =   False
      ValidationMask  =   ""
      Visible         =   True
      Width           =   340
   End
   Begin DesktopTextField meal2_ready
      AllowAutoDeactivate=   True
      AllowFocusRing  =   True
      AllowSpellChecking=   False
      AllowTabs       =   False
      BackgroundColor =   &cFFFFFF00
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Format          =   ""
      HasBorder       =   True
      Height          =   32
      Hint            =   ""
      Index           =   -2147483648
      Italic          =   False
      Left            =   312
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      MaximumCharactersAllowed=   0
      Password        =   False
      ReadOnly        =   True
      Scope           =   0
      TabIndex        =   8
      TabPanelIndex   =   0
      TabStop         =   False
      Text            =   ""
      TextAlignment   =   0
      TextColor       =   &c000000
      Tooltip         =   ""
      Top             =   275
      Transparent     =   False
      Underline       =   False
      ValidationMask  =   ""
      Visible         =   True
      Width           =   340
   End
   Begin DesktopTextField meal3_ready
      AllowAutoDeactivate=   True
      AllowFocusRing  =   True
      AllowSpellChecking=   False
      AllowTabs       =   False
      BackgroundColor =   &cEAEFEA00
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Format          =   ""
      HasBorder       =   True
      Height          =   32
      Hint            =   ""
      Index           =   -2147483648
      Italic          =   False
      Left            =   312
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      MaximumCharactersAllowed=   0
      Password        =   False
      ReadOnly        =   True
      Scope           =   0
      TabIndex        =   9
      TabPanelIndex   =   0
      TabStop         =   False
      Text            =   ""
      TextAlignment   =   0
      TextColor       =   &c000000
      Tooltip         =   ""
      Top             =   365
      Transparent     =   False
      Underline       =   False
      ValidationMask  =   ""
      Visible         =   True
      Width           =   340
   End
   Begin DesktopTextField kcal_enter
      AllowAutoDeactivate=   True
      AllowFocusRing  =   True
      AllowSpellChecking=   False
      AllowTabs       =   False
      BackgroundColor =   &cFFFFFF00
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Format          =   ""
      HasBorder       =   True
      Height          =   32
      Hint            =   ""
      Index           =   -2147483648
      Italic          =   False
      Left            =   95
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MaximumCharactersAllowed=   4
      Password        =   False
      ReadOnly        =   False
      Scope           =   0
      TabIndex        =   10
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   ""
      TextAlignment   =   2
      TextColor       =   &c000000
      Tooltip         =   ""
      Top             =   52
      Transparent     =   False
      Underline       =   False
      ValidationMask  =   "####"
      Visible         =   True
      Width           =   50
   End
   Begin DesktopLabel Label4
      AllowAutoDeactivate=   True
      Bold            =   True
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      Italic          =   False
      Left            =   20
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   13
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "ENERGY"
      TextAlignment   =   1
      TextColor       =   &c000000
      Tooltip         =   ""
      Top             =   56
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   70
   End
   Begin DesktopLabel Label5
      AllowAutoDeactivate=   True
      Bold            =   True
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      Italic          =   False
      Left            =   153
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   14
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Kcal"
      TextAlignment   =   1
      TextColor       =   &c000000
      Tooltip         =   ""
      Top             =   56
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   50
   End
   Begin DesktopButton Estimate_btn
      AllowAutoDeactivate=   True
      Bold            =   False
      Cancel          =   False
      Caption         =   "Estimate"
      Default         =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   32
      Index           =   -2147483648
      Italic          =   False
      Left            =   95
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MacButtonStyle  =   0
      Scope           =   0
      TabIndex        =   15
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   "Daily calories"
      Top             =   93
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   80
   End
   Begin DesktopLabel Label6
      AllowAutoDeactivate=   True
      Bold            =   True
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      Italic          =   False
      Left            =   24
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   16
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "MEAL 4 -"
      TextAlignment   =   0
      TextColor       =   &c000000
      Tooltip         =   ""
      Top             =   415
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   65
   End
   Begin DesktopPopupMenu meal4_protein_popup
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   32
      Index           =   -2147483648
      InitialValue    =   ""
      Italic          =   False
      Left            =   95
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   0
      SelectedRowIndex=   -1
      TabIndex        =   7
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   "Protein"
      Top             =   415
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   190
   End
   Begin DesktopPopupMenu meal4_extra_popup
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   32
      Index           =   -2147483648
      InitialValue    =   ""
      Italic          =   False
      Left            =   95
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   0
      SelectedRowIndex=   -1
      TabIndex        =   8
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   "Extras"
      Top             =   455
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   190
   End
   Begin DesktopTextField meal4_ready
      AllowAutoDeactivate=   True
      AllowFocusRing  =   True
      AllowSpellChecking=   False
      AllowTabs       =   False
      BackgroundColor =   &cFFFFFF00
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Format          =   ""
      HasBorder       =   True
      Height          =   32
      Hint            =   ""
      Index           =   -2147483648
      Italic          =   False
      Left            =   312
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      MaximumCharactersAllowed=   0
      Password        =   False
      ReadOnly        =   True
      Scope           =   0
      TabIndex        =   19
      TabPanelIndex   =   0
      TabStop         =   False
      Text            =   ""
      TextAlignment   =   0
      TextColor       =   &c000000
      Tooltip         =   ""
      Top             =   455
      Transparent     =   False
      Underline       =   False
      ValidationMask  =   ""
      Visible         =   True
      Width           =   340
   End
   Begin DesktopRadioGroup system_select
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   70
      Horizontal      =   False
      Index           =   -2147483648
      InitialValue    =   "Simple\n3 Meals\n4 Meals"
      Italic          =   False
      Left            =   207
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   0
      SelectedIndex   =   0
      TabIndex        =   20
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   53
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   100
   End
   Begin DesktopLabel totals_m1
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   12.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      Italic          =   False
      Left            =   314
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   23
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Untitled"
      TextAlignment   =   0
      TextColor       =   &c000000
      Tooltip         =   ""
      Top             =   218
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   340
   End
   Begin DesktopLabel totals_m2
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   12.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      Italic          =   False
      Left            =   314
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   24
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Untitled"
      TextAlignment   =   0
      TextColor       =   &c000000
      Tooltip         =   ""
      Top             =   308
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   340
   End
   Begin DesktopLabel totals_m3
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   12.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      Italic          =   False
      Left            =   314
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   25
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Untitled"
      TextAlignment   =   0
      TextColor       =   &c000000
      Tooltip         =   ""
      Top             =   398
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   340
   End
   Begin DesktopLabel totals_m4
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   12.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      Italic          =   False
      Left            =   314
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   26
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Untitled"
      TextAlignment   =   0
      TextColor       =   &c000000
      Tooltip         =   ""
      Top             =   488
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   340
   End
   Begin DesktopLabel Label7
      AllowAutoDeactivate=   True
      Bold            =   True
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      Italic          =   False
      Left            =   312
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   27
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Meal #1 - 12 Noon"
      TextAlignment   =   0
      TextColor       =   &c000000
      Tooltip         =   ""
      Top             =   160
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   169
   End
   Begin DesktopLabel Label8
      AllowAutoDeactivate=   True
      Bold            =   True
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      Italic          =   False
      Left            =   312
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   28
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Meal #2 - 3 PM"
      TextAlignment   =   0
      TextColor       =   &c000000
      Tooltip         =   ""
      Top             =   250
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   169
   End
   Begin DesktopLabel Label9
      AllowAutoDeactivate=   True
      Bold            =   True
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      Italic          =   False
      Left            =   312
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   29
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Meal #3 - 6 PM"
      TextAlignment   =   0
      TextColor       =   &c000000
      Tooltip         =   ""
      Top             =   340
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   169
   End
   Begin DesktopLabel Label10
      AllowAutoDeactivate=   True
      Bold            =   True
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      Italic          =   False
      Left            =   312
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   30
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Meal #4 - 9 PM"
      TextAlignment   =   1
      TextColor       =   &c000000
      Tooltip         =   ""
      Top             =   430
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   169
   End
   Begin DesktopCheckBox Macro_checkbox
      AllowAutoDeactivate=   True
      Bold            =   False
      Caption         =   "View Macros"
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   22
      Index           =   -2147483648
      Italic          =   False
      Left            =   312
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   0
      TabIndex        =   31
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   52
      Transparent     =   False
      Underline       =   False
      Value           =   False
      Visible         =   True
      VisualState     =   0
      Width           =   125
   End
   Begin DesktopLabel Label11
      AllowAutoDeactivate=   True
      Bold            =   True
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   22
      Index           =   -2147483648
      Italic          =   False
      Left            =   312
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   32
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Totals"
      TextAlignment   =   0
      TextColor       =   &c000000
      Tooltip         =   ""
      Top             =   76
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   60
   End
   Begin DesktopLabel totals_all
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      Italic          =   False
      Left            =   312
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   33
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Untitled"
      TextAlignment   =   0
      TextColor       =   &c000000
      Tooltip         =   ""
      Top             =   99
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   340
   End
   Begin DesktopLabel totals_all_percent
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      Italic          =   False
      Left            =   312
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      Multiline       =   False
      Scope           =   0
      Selectable      =   False
      TabIndex        =   34
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Untitled"
      TextAlignment   =   0
      TextColor       =   &c000000
      Tooltip         =   ""
      Top             =   122
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   336
   End
   Begin DesktopButton Copy_btn
      AllowAutoDeactivate=   True
      Bold            =   False
      Cancel          =   False
      Caption         =   "Copy"
      Default         =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   32
      Index           =   -2147483648
      Italic          =   False
      Left            =   568
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MacButtonStyle  =   0
      Scope           =   0
      TabIndex        =   35
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   "To Clipboard"
      Top             =   52
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   80
   End
   Begin DesktopSeparator Separator1
      Active          =   False
      AllowAutoDeactivate=   True
      AllowTabStop    =   True
      Enabled         =   True
      Height          =   20
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   312
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      PanelIndex      =   0
      Scope           =   0
      TabIndex        =   36
      TabPanelIndex   =   0
      Tooltip         =   ""
      Top             =   137
      Transparent     =   False
      Visible         =   True
      Width           =   340
      _mIndex         =   0
      _mInitialParent =   ""
      _mName          =   ""
      _mPanelIndex    =   0
   End
   Begin DesktopCheckBox MemMeals_CheckBox
      AllowAutoDeactivate=   True
      Bold            =   False
      Caption         =   "REM"
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   32
      Index           =   -2147483648
      Italic          =   False
      Left            =   95
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   0
      TabIndex        =   37
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   "Keep in memory"
      Top             =   498
      Transparent     =   False
      Underline       =   False
      Value           =   False
      Visible         =   False
      VisualState     =   0
      Width           =   67
   End
   Begin DesktopButton LogMealplan_btn
      AllowAutoDeactivate=   True
      Bold            =   False
      Cancel          =   False
      Caption         =   "Log Plan"
      Default         =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   2
      Height          =   32
      Index           =   -2147483648
      Italic          =   False
      Left            =   468
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MacButtonStyle  =   0
      Scope           =   0
      TabIndex        =   38
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   52
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   80
   End
   Begin DesktopButton Clear_btn
      AllowAutoDeactivate=   True
      Bold            =   False
      Cancel          =   False
      Caption         =   "Clear"
      Default         =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   32
      Index           =   -2147483648
      Italic          =   False
      Left            =   232
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MacButtonStyle  =   0
      Scope           =   0
      TabIndex        =   40
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   "Reset meals"
      Top             =   498
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   54
   End
   Begin DesktopCanvas Canvas1
      AllowAutoDeactivate=   True
      AllowFocus      =   False
      AllowFocusRing  =   True
      AllowTabs       =   False
      Backdrop        =   1215971327
      Enabled         =   True
      Height          =   39
      Index           =   -2147483648
      Left            =   0
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      Scope           =   0
      TabIndex        =   41
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   0
      Transparent     =   True
      Visible         =   True
      Width           =   675
      Begin DesktopLabel Label13
         AllowAutoDeactivate=   True
         Bold            =   True
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   18.0
         FontUnit        =   0
         Height          =   28
         Index           =   -2147483648
         InitialParent   =   "Canvas1"
         Italic          =   False
         Left            =   188
         LockBottom      =   False
         LockedInPosition=   False
         LockLeft        =   True
         LockRight       =   False
         LockTop         =   True
         Multiline       =   False
         Scope           =   0
         Selectable      =   False
         TabIndex        =   0
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   "Weight Loss System"
         TextAlignment   =   0
         TextColor       =   &cFFFFFF00
         Tooltip         =   ""
         Top             =   6
         Transparent     =   False
         Underline       =   False
         Visible         =   True
         Width           =   214
      End
      Begin DesktopLabel Companylabel
         AllowAutoDeactivate=   True
         Bold            =   False
         Enabled         =   True
         FontName        =   "System"
         FontSize        =   0.0
         FontUnit        =   0
         Height          =   20
         Index           =   -2147483648
         InitialParent   =   "Canvas1"
         Italic          =   True
         Left            =   461
         LockBottom      =   False
         LockedInPosition=   False
         LockLeft        =   True
         LockRight       =   False
         LockTop         =   True
         Multiline       =   False
         Scope           =   0
         Selectable      =   False
         TabIndex        =   1
         TabPanelIndex   =   0
         TabStop         =   True
         Text            =   "Untitled"
         TextAlignment   =   3
         TextColor       =   &cFFFFFF00
         Tooltip         =   ""
         Top             =   9
         Transparent     =   False
         Underline       =   False
         Visible         =   True
         Width           =   125
      End
   End
   Begin DesktopButton Button1
      AllowAutoDeactivate=   True
      Bold            =   False
      Cancel          =   False
      Caption         =   "DB"
      Default         =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   28
      Index           =   -2147483648
      Italic          =   False
      Left            =   608
      LockBottom      =   False
      LockedInPosition=   True
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   True
      MacButtonStyle  =   0
      Scope           =   0
      TabIndex        =   42
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   153
      Transparent     =   False
      Underline       =   False
      Visible         =   False
      Width           =   40
   End
End
#tag EndDesktopWindow

#tag WindowCode
	#tag Event
		Sub Closing()
		  
		  //Finalize all on closing
		  Finalize
		End Sub
	#tag EndEvent

	#tag Event
		Sub Opening()
		  
		  //Call method to initialize all
		  Initialize
		  
		  
		End Sub
	#tag EndEvent


	#tag Method, Flags = &h0
		Sub calcmealdatatotals()
		  //Formulas based on System: Simple, 3-meals or 4-meals
		  
		  //For totalprotein,totalcarb,totalfat calculation
		  Var tp,tc,tf as double
		  
		  'THE SIMPLE SYSTEM
		  If system_select.SelectedIndex = 0 Then
		    M1_kcal = userkcal*0.40 'Kcal for Simple Carb
		    M2_kcal = userkcal*0.35 'Kcal for Complex Carb
		    M3_kcal = userkcal*0.25 'Kcal for Green Carb
		    
		    'Calculate amounts Meal1
		    If meal1_simple_popup.SelectedRowIndex > 0 Then
		      M1_grams = (M1_kcal / meal1_data(0) * 100)
		      meal1_ready.Text = meal1_simple_popup.SelectedRowValue+" "+Str(Round(M1_grams))+"g"
		      
		      'Calc combined macro nutrients
		      totals_m1.Text = "Kcal: "+ Str(Round(M1_grams*meal1_data(0)/100))+_
		      " - Protein: "+Str(Round(M1_grams*meal1_data(1)/100))+"g "+_
		      " - Carbs: "+Str(Round(M1_grams*meal1_data(2)/100))+"g "+_
		      " - Fat: "+Str(Round(M1_grams*meal1_data(3)/100))+"g"
		    End If
		    
		    'Calculate amounts Meal2
		    If meal2_complex_popup.SelectedRowIndex > 0 And meal2_extra_popup.SelectedRowIndex >0 Then
		      M2_grams = (M2_kcal / meal2_data(0) * 100)
		      ''Check if Extra is omitted
		      If meal2_extra_popup.SelectedRowValue = "-Skip Extra" Then
		        meal2_ready.Text = meal2_complex_popup.SelectedRowValue+" "+Str(Round(M2_grams))+"g"
		      Else
		        meal2_ready.Text = meal2_complex_popup.SelectedRowValue+" "+Str(Round(M2_grams))+"g + "+_
		        meal2_extra_popup.SelectedRowValue
		      End If
		      
		      'Calc combined macro nutrients (extras are not counted for meal2)
		      totals_m2.Text = "Kcal: "+ Str(Round(M2_grams*meal2_data(0)/100))+_
		      " - Protein: "+Str(Round(M2_grams*meal2_data(1)/100))+"g "+_
		      " - Carbs: "+Str(Round(M2_grams*meal2_data(2)/100))+"g "+_
		      " - Fat: "+Str(Round(M2_grams*meal2_data(3)/100))+"g"
		    End If
		    
		    'Calculate amounts Meal3
		    If meal3_greens_popup.SelectedRowIndex > 0 Then
		      M3_grams = (M3_kcal / meal3_data(0) * 100)
		      meal3_ready.Text = meal3_greens_popup.SelectedRowValue+" "+Str(Round(M3_grams))+"g"
		      
		      'Calc combined macro nutrients
		      totals_m3.Text = "Kcal: "+ Str(Round(M3_grams*meal3_data(0)/100))+_
		      " - Protein: "+Str(Round(M3_grams*meal3_data(1)/100))+"g "+_
		      " - Carbs: "+Str(Round(M3_grams*meal3_data(2)/100))+"g "+_
		      " - Fat: "+Str(Round(M3_grams*meal3_data(3)/100))+"g"
		    End If
		    
		    ''Sum up totals for Simple System
		    totalkcal = 0 //Reset to zero before final calculations
		    
		    totalkcal = (M1_grams*meal1_data(0)/100)+_
		    (M2_grams*meal2_data(0)/100)+(M3_grams*meal3_data(0)/100)
		    
		    totalprotein = (M1_grams*meal1_data(1)/100)+_
		    (M2_grams*meal2_data(1)/100)+(M3_grams*meal3_data(1)/100)
		    
		    totalcarb = (M1_grams*meal1_data(2)/100)+_
		    (M2_grams*meal2_data(2)/100)+(M3_grams*meal3_data(2)/100)
		    
		    totalfat = (M1_grams*meal1_data(3)/100)+_
		    (M2_grams*meal2_data(3)/100)+(M3_grams*meal3_data(3)/100)
		    //Finally show totals
		    If totalkcal > 0 Then
		      totals_all.Text = "Kcal: "+Str(Round(totalkcal))+" - Protein: "+Str(Round(TotalProtein))+"g"_
		      +" - Carbs: "+Str(Round(TotalCarb))+"g"+" - Fat: "+Str(Round(totalfat))+"g"
		      
		      //Ratios of macros in energy percentage of total kcal
		      tp = Round((Totalprotein*4)/(Totalkcal/100))
		      tc = Round((TotalCarb*4)/(totalkcal/100))
		      tf = 100-tp-tc // For displaying round total = 100%
		      
		      //Display rounded macro percentage
		      totals_all_percent.Text = "Energy - Protein: "+_
		      Str(tp)+"% - Carbs: "+_
		      Str(tc)+"% - Fat: "+_
		      Str(tf)+"%" 
		    Else 
		      totals_all.Text = ""
		      totals_all_percent.Text = ""
		    End If
		    
		    //---------------------
		    //THE THREE MEAL SYSTEM
		  ElseIf system_select.SelectedIndex = 1 Then
		    
		    M1_kcal = userkcal*0.35  'kcal for Simple Carb
		    M1b_kcal = userkcal*0.05 'kcal for Protein
		    M2_kcal = userkcal*0.35  'Kcal for Complex Carb
		    M3_kcal = userkcal*0.15  'Kcal for Greens
		    M3b_kcal = userkcal*0.10 'kcal for Legumes for Vegan or Proteins for Standard
		    
		    'Calculate amounts Meal1
		    If meal1_simple_popup.SelectedRowIndex > 0 And meal1_protein_popup.SelectedRowIndex >0 Then
		      M1_grams = (M1_kcal / meal1_data(0) * 100)
		      M1b_grams = (M1b_kcal / meal1b_data(0) * 100)
		      meal1_ready.Text = meal1_simple_popup.SelectedRowValue+" "+Str(Round(M1_grams))+"g + "_
		      +meal1_protein_popup.SelectedRowValue +" "+Str(Round(M1b_grams))+"g"
		      
		      'Calc combined macro nutrients
		      totals_m1.Text = "Kcal: "+ Str(Round(M1_grams*meal1_data(0)/100)+(Round(M1b_grams*meal1b_data(0)/100)))+_
		      " - Protein: "+Str(Round((M1_grams*meal1_data(1)/100)+(M1b_grams*meal1b_data(1)/100)))+"g "+_
		      " - Carbs: "+Str(Round((M1_grams*meal1_data(2)/100)+(M1b_grams*meal1b_data(2)/100)))+"g "+_
		      " - Fat: "+Str(Round((M1_grams*meal1_data(3)/100)+(M1b_grams*meal1b_data(3)/100)))+"g"
		    End If
		    
		    'Calculate amounts Meal2
		    If meal2_complex_popup.SelectedRowIndex > 0 And meal2_extra_popup.SelectedRowIndex >0 Then
		      M2_grams = (M2_kcal / meal2_data(0) * 100)
		      
		      ''Check if Extra is omitted
		      If meal2_extra_popup.SelectedRowValue = "-Skip Extra" Then
		        meal2_ready.Text = meal2_complex_popup.SelectedRowValue+" "+Str(Round(M2_grams))+"g"
		      Else
		        meal2_ready.Text = meal2_complex_popup.SelectedRowValue+" "+Str(Round(M2_grams))+"g + "+_
		        meal2_extra_popup.SelectedRowValue
		      End If
		      
		      'Calc combined macro nutrients (extras are not counted for meal2)
		      totals_m2.Text = "Kcal: "+ Str(Round(M2_grams*meal2_data(0)/100))+_
		      " - Protein: "+Str(Round(M2_grams*meal2_data(1)/100))+"g "+_
		      " - Carbs: "+Str(Round(M2_grams*meal2_data(2)/100))+"g "+_
		      " - Fat: "+Str(Round(M2_grams*meal2_data(3)/100))+"g"
		    End If
		    
		    'Calculate amounts Meal3
		    If meal3_greens_popup.SelectedRowIndex > 0 And meal3_fats_popup.SelectedRowIndex >0 Then
		      M3_grams = (M3_kcal / meal3_data(0) * 100)
		      M3b_grams = (M3b_kcal / meal3b_data(0) * 100)
		      meal3_ready.Text = meal3_greens_popup.SelectedRowValue+" "+Str(Round(M3_grams))+"g + "_
		      +meal3_fats_popup.SelectedRowValue +" "+Str(Round(M3b_grams))+"g"
		      
		      'Calc combined macro nutrients
		      totals_m3.Text = "Kcal: "+ Str(Round(M3_grams*meal3_data(0)/100)+(Round(M3b_grams*meal3b_data(0)/100)))+_
		      " - Protein: "+Str(Round((M3_grams*meal3_data(1)/100)+(M3b_grams*meal3b_data(1)/100)))+"g "+_
		      " - Carbs: "+Str(Round((M3_grams*meal3_data(2)/100)+(M3b_grams*meal3b_data(2)/100)))+"g "+_
		      " - Fat: "+Str(Round((M3_grams*meal3_data(3)/100)+(M3b_grams*meal3b_data(3)/100)))+"g"
		    End If
		    
		    //Sum up totals for the 3-Meal System
		    totalkcal = (M1_grams*meal1_data(0)/100)+(M1b_grams*meal1b_data(0)/100)+_
		    (M2_grams*meal2_data(0)/100)+(M3_grams*meal3_data(0)/100)+(M3b_grams*meal3b_data(0)/100)
		    
		    totalprotein = (M1_grams*meal1_data(1)/100)+(M1b_grams*meal1b_data(1)/100)+_
		    (M2_grams*meal2_data(1)/100)+(M3_grams*meal3_data(1)/100)+(M3b_grams*meal3b_data(1)/100)
		    
		    totalcarb = (M1_grams*meal1_data(2)/100)+(M1b_grams*meal1b_data(2)/100)+_
		    (M2_grams*meal2_data(2)/100)+(M3_grams*meal3_data(2)/100)+(M3b_grams*meal3b_data(2)/100)
		    
		    totalfat = (M1_grams*meal1_data(3)/100)+(M1b_grams*meal1b_data(3)/100)+_
		    (M2_grams*meal2_data(3)/100)+(M3_grams*meal3_data(3)/100)+(M3b_grams*meal3b_data(3)/100)
		    
		    ''Finally show rounded totals for the 3-Meal System
		    If totalkcal > 0 Then
		      totals_all.Text = "Kcal: "+Str(Round(totalkcal))+" - Protein: "+Str(Round(TotalProtein))+"g"_
		      +" - Carbs: "+Str(Round(TotalCarb))+"g"+" - Fat: "+Str(Round(totalfat))+"g"
		      
		      'Ratios of macros in energy percentage of total kcal
		      tp = Round((Totalprotein*4)/(Totalkcal/100))
		      tc = Round((TotalCarb*4)/(totalkcal/100))
		      tf = 100-tp-tc // For displaying round total = 100%
		      
		      'Display rounded macro percentage
		      totals_all_percent.Text = "Energy - Protein: "+_
		      Str(tp)+"% - Carbs: "+_
		      Str(tc)+"% - Fat: "+_
		      Str(tf)+"%" //+" =("+str(tp+tc+tf)+")"
		    End If
		    
		    '-----------------------------------------
		    'THE FOUR MEAL SYSTEM - Original
		  ElseIf system_select.SelectedIndex = 2 Then
		    
		    //Adjust macro divisions 
		    If userkcal > 2200 Then //Above 220 Kcal
		      M1_kcal = userkcal*0.30 'kcal for Simple Carbs
		      M1b_kcal = userkcal*0.05 'kcal for protein
		      M2_kcal = userkcal*0.30 'kcal Complex carbs
		      M3_kcal = userkcal*0.15 'kcal green carbs
		      M3b_kcal = userkcal*0.10 'kcal for fat
		      M4_Kcal = userkcal*0.10 'kcal for Protein
		      
		    Else //(Trim plan) Normal macros =<2200 Kcal
		      M1_kcal = userkcal*0.35 'kcal for Simple Carbs
		      M1b_kcal = userkcal*0.05 'kcal for protein
		      M2_kcal = userkcal*0.30 'kcal Complex carbs
		      M3_kcal = userkcal*0.10 'kcal green carbs
		      M3b_kcal = userkcal*0.10 'kcal for fat
		      M4_Kcal = userkcal*0.10 'kcal for Protein
		    End If
		    'Calculate amounts Meal1
		    If meal1_simple_popup.SelectedRowIndex > 0 And meal1_protein_popup.SelectedRowIndex >0 Then
		      M1_grams = (M1_kcal / meal1_data(0) * 100)
		      M1b_grams = (M1b_kcal / meal1b_data(0) * 100)
		      meal1_ready.Text = meal1_simple_popup.SelectedRowValue+" "+Str(Round(M1_grams))+"g + "_
		      +meal1_protein_popup.SelectedRowValue +" "+Str(Round(M1b_grams))+"g"
		      
		      'Calc combined macro nutrients
		      totals_m1.Text = "Kcal: "+ Str(Round(M1_grams*meal1_data(0)/100)+(Round(M1b_grams*meal1b_data(0)/100)))+_
		      " - Protein: "+Str(Round((M1_grams*meal1_data(1)/100)+(M1b_grams*meal1b_data(1)/100)))+"g "+_
		      " - Carbs: "+Str(Round((M1_grams*meal1_data(2)/100)+(M1b_grams*meal1b_data(2)/100)))+"g "+_
		      " - Fat: "+Str(Round((M1_grams*meal1_data(3)/100)+(M1b_grams*meal1b_data(3)/100)))+"g"
		    End If
		    
		    'Calculate amounts Meal2
		    If meal2_complex_popup.SelectedRowIndex > 0 And meal2_extra_popup.SelectedRowIndex >0 Then
		      M2_grams = (M2_kcal / meal2_data(0) * 100)
		      
		      ''Check if Extra is omitted
		      If meal2_extra_popup.SelectedRowValue = "-Skip Extra" Then
		        meal2_ready.Text = meal2_complex_popup.SelectedRowValue+" "+Str(Round(M2_grams))+"g"
		      Else
		        meal2_ready.Text = meal2_complex_popup.SelectedRowValue+" "+Str(Round(M2_grams))+"g + "+_
		        meal2_extra_popup.SelectedRowValue
		      End If
		      
		      'Calc combined macro nutrients (extras are not counted for meal2)
		      totals_m2.Text = "Kcal: "+ Str(Round(M2_grams*meal2_data(0)/100))+_
		      " - Protein: "+Str(Round(M2_grams*meal2_data(1)/100))+"g "+_
		      " - Carbs: "+Str(Round(M2_grams*meal2_data(2)/100))+"g "+_
		      " - Fat: "+Str(Round(M2_grams*meal2_data(3)/100))+"g"
		    End If
		    
		    'Calculate amounts Meal3
		    If meal3_greens_popup.SelectedRowIndex > 0 And meal3_fats_popup.SelectedRowIndex >0 Then
		      M3_grams = (M3_kcal / meal3_data(0) * 100)
		      M3b_grams = (M3b_kcal / meal3b_data(0) * 100)
		      meal3_ready.Text = meal3_greens_popup.SelectedRowValue+" "+Str(Round(M3_grams))+"g + "_
		      +meal3_fats_popup.SelectedRowValue +" "+Str(Round(M3b_grams))+"g"
		      
		      'Calc combined macro nutrients
		      totals_m3.Text = "Kcal: "+ Str(Round(M3_grams*meal3_data(0)/100)+(Round(M3b_grams*meal3b_data(0)/100)))+_
		      " - Protein: "+Str(Round((M3_grams*meal3_data(1)/100)+(M3b_grams*meal3b_data(1)/100)))+"g "+_
		      " - Carbs: "+Str(Round((M3_grams*meal3_data(2)/100)+(M3b_grams*meal3b_data(2)/100)))+"g "+_
		      " - Fat: "+Str(Round((M3_grams*meal3_data(3)/100)+(M3b_grams*meal3b_data(3)/100)))+"g"
		    End If
		    
		    'Calculate amounts Meal4
		    If meal4_protein_popup.SelectedRowIndex > 0 And meal4_extra_popup.SelectedRowIndex >0 Then
		      M4_grams = (M4_kcal / meal4_data(0) * 100)
		      
		      ''Check if Extra is omitted
		      If meal4_extra_popup.SelectedRowValue = "-Skip Extra" Then
		        meal4_ready.Text = meal4_protein_popup.SelectedRowValue+" "+Str(Round(M4_grams))+"g"
		      Else
		        meal4_ready.Text = meal4_protein_popup.SelectedRowValue+" "+Str(Round(M4_grams))+"g + "+_
		        meal4_extra_popup.SelectedRowValue
		      End If
		      
		      'Calc combined macro nutrients (extras are not counted for meal4)
		      totals_m4.Text = "Kcal: "+ Str(Round(M4_grams*meal4_data(0)/100))+_
		      " - Protein: "+Str(Round(M4_grams*meal4_data(1)/100))+"g "+_
		      " - Carbs: "+Str(Round(M4_grams*meal4_data(2)/100))+"g "+_
		      " - Fat: "+Str(Round(M4_grams*meal4_data(3)/100))+"g"
		    End If
		    
		    //Sum up totals for the 4-Meal System
		    totalkcal = ((M1_grams*meal1_data(0)/100)+(M1b_grams*meal1b_data(0)/100)+_
		    (M2_grams*meal2_data(0)/100)+(M3_grams*meal3_data(0)/100)+(M3b_grams*meal3b_data(0)/100)+_
		    (M4_grams*meal4_data(0)/100))
		    
		    totalprotein = ((M1_grams*meal1_data(1)/100)+(M1b_grams*meal1b_data(1)/100)+_
		    (M2_grams*meal2_data(1)/100)+(M3_grams*meal3_data(1)/100)+(M3b_grams*meal3b_data(1)/100)+_
		    (M4_grams*meal4_data(1)/100))
		    
		    totalcarb = ((M1_grams*meal1_data(2)/100)+(M1b_grams*meal1b_data(2)/100)+_
		    (M2_grams*meal2_data(2)/100)+(M3_grams*meal3_data(2)/100)+(M3b_grams*meal3b_data(2)/100)+_
		    (M4_grams*meal4_data(2)/100))
		    
		    totalfat = ((M1_grams*meal1_data(3)/100)+(M1b_grams*meal1b_data(3)/100)+_
		    (M2_grams*meal2_data(3)/100)+(M3_grams*meal3_data(3)/100)+(M3b_grams*meal3b_data(3)/100)+_
		    (M4_grams*meal4_data(3)/100))
		    
		    'Finally show totals for the 4-Meal System
		    If totalkcal > 0 Then
		      totals_all.Text = "Kcal: "+Str(Round(totalkcal))+" - Protein: "+Str(Round(TotalProtein))+"g"_
		      +" - Carbs: "+Str(Round(TotalCarb))+"g"+" - Fat: "+Str(Round(totalfat))+"g"
		      
		      'Ratios of macros in energy percentage of total kcal
		      tp = Round((Totalprotein*4)/(Totalkcal/100))
		      tc = Round((TotalCarb*4)/(totalkcal/100))
		      tf = 100-tp-tc // For displaying round total = 100%
		      
		      'Display rounded macro percentage
		      totals_all_percent.Text = "Energy - Protein: "+_
		      Str(tp)+"% - Carbs: "+_
		      Str(tc)+"% - Fat: "+_
		      Str(tf)+"%" 
		    End If
		  End If
		  
		  
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub Finalize()
		  
		  //Finalize changes to DB before closing app
		  
		  Var db As New SQLiteDatabase
		  db.Databasefile = app.dbpath
		  
		  Var sql As String
		  Try
		    db.Connect
		    
		    Var rs As RowSet
		    rs = db.SelectSQL("Select * from settings where id=1")
		    
		    If rs<>Nil Then
		      rs.EditRow
		      
		      //Foodsystem
		      rs.Column("foodsystem").StringValue = App.FoodSystem
		      
		      //Select Meal System Simple, 3-Meals or 4-Meals
		      rs.Column("selectroutine").IntegerValue = system_select.SelectedIndex
		      
		      rs.Column("us_metric").BooleanValue = us_metric
		      rs.Column("male").BooleanValue = male
		      rs.Column("female").BooleanValue = female
		      rs.Column("age").integervalue = age
		      rs.Column("weight").DoubleValue = weight
		      rs.Column("height_a").IntegerValue = height_a
		      rs.Column("height_b").IntegerValue = height_b
		      rs.Column("bodyfat").DoubleValue = bodyfat
		      rs.Column("objective").IntegerValue = objective
		      rs.Column("activity_level").IntegerValue = activity_level
		      rs.Column("kcal_startpoint").IntegerValue = userkcal
		      rs.Column("notepad").StringValue = NotebookText
		      
		      //Meals in memory
		      rs.Column("mem_meals").BooleanValue = MemMeals_CheckBox.value
		      rs.Column("m1a_memory").IntegerValue = meal1_simple_popup.SelectedRowIndex
		      rs.Column("m1b_memory").IntegerValue = meal1_protein_popup.SelectedRowIndex
		      rs.Column("m2a_memory").IntegerValue = meal2_complex_popup.SelectedRowIndex
		      rs.Column("m2b_memory").IntegerValue = meal2_extra_popup.SelectedRowIndex
		      rs.Column("m3a_memory").IntegerValue = meal3_greens_popup.SelectedRowIndex
		      rs.Column("m3b_memory").IntegerValue = meal3_fats_popup.SelectedRowIndex
		      rs.Column("m4a_memory").IntegerValue = meal4_protein_popup.SelectedRowIndex
		      rs.Column("m4b_memory").IntegerValue = meal4_extra_popup.SelectedRowIndex
		      
		      rs.SaveRow
		      db.Commit
		    End If
		    
		  Catch error As DatabaseException
		    Beep
		    MessageBox("Database Error: " + Str(db.ErrorCode) + EndOfLine + _
		    EndOfLine + db.ErrorMessage)
		  End Try
		  
		  
		  '''mealdata.close
		  'bidrag.close
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub Initialize()
		  
		  //Check if db is located correctly
		  Var f As FolderItem
		  f = SpecialFolder.Variable.Child("opt").Child("fatx").Child("fatx.sqlite")
		  //f = SpecialFolder.CurrentWorkingDirectory.Child("fatx.sqlite")
		  
		  If f <> Nil And f.Exists Then
		    app.dbpath = f //Specify global value to sqlite database
		  Else
		    //Database not found
		  End If
		  
		  
		  //Initialize app settings from DB
		  Var db As New SQLiteDatabase
		  db.Databasefile = app.dbpath
		  
		  //Open and Read complete settings from Database
		  Try 
		    db.Connect
		    
		    //Get all data from Settings in db
		    Var rs As RowSet
		    rs = db.SelectSQL("select * from settings where id =1")
		    
		    //FoodSystem
		    App.FoodSystem = rs.Column("foodsystem").StringValue
		    
		    //Select Meal System Simple, 3-Meals or 4-Meals
		    system_select.SelectedIndex = rs.Column("selectroutine").IntegerValue
		    
		    //Calculator settings
		    us_metric = rs.Column("us_metric").BooleanValue
		    male = rs.Column("male").BooleanValue
		    female= rs.Column("female").BooleanValue
		    weight = rs.Column("weight").DoubleValue
		    age = rs.Column("age").IntegerValue
		    height_a = rs.Column("height_a").IntegerValue
		    height_b = rs.Column("height_b").IntegerValue
		    bodyfat = rs.Column("bodyfat").DoubleValue
		    objective = rs.Column("objective").Integervalue
		    activity_level = rs.Column("activity_level").IntegerValue
		    userkcal = rs.Column("kcal_startpoint").IntegerValue
		    
		    //Meals in memory
		    MemMeals_CheckBox.Value = rs.Column("mem_meals").BooleanValue
		    meal_mem(0) = rs.Column("m1a_memory").IntegerValue
		    meal_mem(1) = rs.Column("m1b_memory").IntegerValue
		    meal_mem(2) = rs.Column("m2a_memory").IntegerValue
		    meal_mem(3) = rs.Column("m2b_memory").IntegerValue
		    meal_mem(4) = rs.Column("m3a_memory").IntegerValue
		    meal_mem(5) = rs.Column("m3b_memory").IntegerValue
		    meal_mem(6) = rs.Column("m4a_memory").IntegerValue
		    meal_mem(7) = rs.Column("m4b_memory").IntegerValue
		    
		    //Extra
		    Notebooktext = rs.Column("notepad").StringValue
		    
		  Catch error As DatabaseException
		    MessageBox("Database Error: " + Str(db.ErrorCode) + EndOfLine + _
		    EndOfLine + db.ErrorMessage)
		  End Try
		  
		  Dim d As New Date
		  Companylabel.Text = "Viridum ©"+Str(d.year)+" "
		  
		  '''------------------------------------
		  
		  //Setup on start
		  kcal_enter.Text = userkcal.ToString
		  
		  //Which system: Simple, 3-meal or 4-meal
		  system_choice() 
		  
		  //Clear nutrients labels below ready meals
		  totals_m1.Text = ""
		  totals_m2.Text = ""
		  totals_m3.Text = ""
		  totals_m4.Text = ""
		  totals_all.Text = ""
		  totals_all_percent.Text = ""
		  label11.Visible = False
		  
		  //View or hide macro labels
		  If macro_checkbox.value = False Then
		    totals_m1.Visible = False
		    totals_m2.Visible = False
		    totals_m3.Visible = False
		    totals_m4.Visible = False
		    totals_all.Visible = False
		    totals_all_percent.Visible = False
		  Else
		    totals_m1.Visible = True
		    totals_m2.Visible = True
		    totals_m3.Visible = True
		    totals_m4.Visible = True
		    totals_all.Visible = True
		    totals_all_percent.Visible = True
		  End If
		  
		  MealRecall
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub load_mealdata()
		  
		  //Get macro data from selected option
		  Var db As New SQLiteDatabase
		  db.Databasefile = app.dbpath
		  
		  Var rs As RowSet
		  
		  Try 
		    db.Connect
		    rs = db.SelectSQL("SELECT * FROM '"+app.foodsystem+"' WHERE gruppe= '"+ foodgroup+"' AND name='"+selectedfood.SafeSQL+"'")
		    
		    If foodgroup = "Simple" Then 
		      meal1_data(0) = rs.Column("kcal").Doublevalue
		      meal1_data(1) = rs.Column("protein").DoubleValue
		      meal1_data(2) = rs.Column("kulhydrat").DoubleValue
		      meal1_data(3) = rs.Column("fedt").DoubleValue
		    End If
		    
		    //Insert protein meal data depending on foodsystem(vegan/standard) and meal selected
		    If app.FoodSystem = "foodbase" then //Vegan
		      
		      If foodgroup = "Protein" Then //Add protein meal data to respectively 1st and 4th meal
		        If selected_meal = 1 Then
		          meal1b_data(0) = rs.Column("kcal").Doublevalue
		          meal1b_data(1) = rs.Column("protein").DoubleValue
		          meal1b_data(2) = rs.Column("kulhydrat").DoubleValue
		          meal1b_data(3) = rs.Column("fedt").DoubleValue
		          
		        ElseIf selected_meal = 4 Then
		          meal4_data(0) = rs.Column("kcal").Doublevalue
		          meal4_data(1) = rs.Column("protein").DoubleValue
		          meal4_data(2) = rs.Column("kulhydrat").DoubleValue
		          meal4_data(3) = rs.Column("fedt").DoubleValue
		          
		        End If
		      End If
		    End If
		    
		    If app.FoodSystem = "foodbase1" then //Standard System
		      
		      If foodgroup = "Protein" Then //Data for meal 1
		        If selected_meal = 1 Then
		          meal1b_data(0) = rs.Column("kcal").Doublevalue
		          meal1b_data(1) = rs.Column("protein").DoubleValue
		          meal1b_data(2) = rs.Column("kulhydrat").DoubleValue
		          meal1b_data(3) = rs.Column("fedt").DoubleValue
		        End if
		        
		      End If
		      
		      If foodgroup = "Protein2" then //Data for meal 4
		        If selected_meal = 4 then
		          meal4_data(0) = rs.Column("kcal").Doublevalue
		          meal4_data(1) = rs.Column("protein").DoubleValue
		          meal4_data(2) = rs.Column("kulhydrat").DoubleValue
		          meal4_data(3) = rs.Column("fedt").DoubleValue
		          
		        End If
		      End If
		    End If
		    
		    
		    If foodgroup = "Complex" Then
		      meal2_data(0) = rs.Column("kcal").DoubleValue
		      meal2_data(1) = rs.Column("protein").DoubleValue
		      meal2_data(2) = rs.Column("kulhydrat").DoubleValue
		      meal2_data(3) = rs.Column("fedt").DoubleValue
		      
		    End If
		    If foodgroup = "Extras" Then
		      If selected_meal = 2 Then
		        meal2b_data(0) = rs.Column("kcal").Doublevalue
		        meal2b_data(1) = rs.Column("protein").DoubleValue
		        meal2b_data(2) = rs.Column("kulhydrat").DoubleValue
		        meal2b_data(3) = rs.Column("fedt").DoubleValue
		        
		      ElseIf selected_meal = 4 Then
		        meal4b_data(0) = rs.Column("kcal").Doublevalue
		        meal4b_data(1) = rs.Column("protein").DoubleValue
		        meal4b_data(2) = rs.Column("kulhydrat").DoubleValue
		        meal4b_data(3) = rs.Column("fedt").DoubleValue
		        
		      End If
		    End If
		    
		    If foodgroup = "Greens" Then
		      meal3_data(0) = rs.Column("kcal").DoubleValue
		      meal3_data(1) = rs.Column("protein").DoubleValue
		      meal3_data(2) = rs.Column("kulhydrat").DoubleValue
		      meal3_data(3) = rs.Column("fedt").DoubleValue
		    End If
		    
		    //For Meal-3 System Vegan
		    If system_select.SelectedIndex = 1 and foodgroup = "Legumes" then
		      meal3b_data(0) = rs.Column("kcal").DoubleValue
		      meal3b_data(1) = rs.Column("protein").DoubleValue
		      meal3b_data(2) = rs.Column("kulhydrat").DoubleValue
		      meal3b_data(3) = rs.Column("fedt").DoubleValue
		    End If
		    
		    //For Meal-3 System Standard
		    If system_select.SelectedIndex = 1 and foodgroup = "Protein2" then
		      meal3b_data(0) = rs.Column("kcal").DoubleValue
		      meal3b_data(1) = rs.Column("protein").DoubleValue
		      meal3b_data(2) = rs.Column("kulhydrat").DoubleValue
		      meal3b_data(3) = rs.Column("fedt").DoubleValue
		    End If
		    
		    If foodgroup = "Fats" Then
		      meal3b_data(0) = rs.Column("kcal").DoubleValue
		      meal3b_data(1) = rs.Column("protein").DoubleValue
		      meal3b_data(2) = rs.Column("kulhydrat").DoubleValue
		      meal3b_data(3) = rs.Column("fedt").DoubleValue
		    End If
		  Catch error As DatabaseException
		    MessageBox("Database Error: " + Str(db.ErrorCode) + EndOfLine + _
		    EndOfLine + db.ErrorMessage)
		  End Try
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub MealRecall()
		  If MemMeals_CheckBox.Value = true then //Display memorized last meals
		    meal1_simple_popup.SelectedRowIndex = meal_mem(0)
		    meal1_protein_popup.SelectedRowIndex = meal_mem(1)
		    meal2_complex_popup.SelectedRowIndex = meal_mem(2)
		    meal2_extra_popup.SelectedRowIndex = meal_mem(3)
		    meal3_greens_popup.SelectedRowIndex = meal_mem(4)
		    meal3_fats_popup.SelectedRowIndex = meal_mem(5)
		    meal4_protein_popup.SelectedRowIndex = meal_mem(6)
		    meal4_extra_popup.SelectedRowIndex = meal_mem(7)
		  End If
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub Populate_selections()
		  
		  //Populate Meal-1 SimpleCarbs selections Popupmenu
		  Var db As New SQLiteDatabase
		  db.Databasefile = app.dbpath
		  
		  Var rs As RowSet
		  
		  Try 
		    db.Connect
		    
		    rs = db.SelectSQL("SELECT name FROM '"+app.foodsystem+"' WHERE gruppe = 'Simple' ORDER BY name ASC")
		    
		    Meal1_Simple_Popup.RemoveAllRows
		    Meal1_Simple_Popup.Addrow("Select")
		    While Not rs.AfterLastRow
		      Meal1_Simple_Popup.AddRow(rs.Column("name").stringvalue)
		      rs.MoveToNextRow
		    Wend
		    rs.close
		    Meal1_Simple_Popup.SelectedRowIndex = 0
		    
		  Catch error As DatabaseException
		    MessageBox("Database Error: " + Str(db.ErrorCode) + EndOfLine + _
		    EndOfLine + db.ErrorMessage)
		  End Try
		  
		  
		  //Populate Meal-1 Protein selections Popupmenu
		  Try 
		    db.Connect
		    
		    rs = db.SelectSQL("SELECT name FROM '"+app.foodsystem+"' WHERE gruppe = 'Protein' ORDER BY name ASC")
		    
		    Meal1_Protein_Popup.RemoveAllRows
		    Meal1_Protein_Popup.Addrow("Select")
		    While Not rs.AfterLastRow
		      Meal1_Protein_Popup.AddRow(rs.Column("name").stringvalue)
		      rs.MoveToNextRow
		    Wend
		    rs.close
		    Meal1_Protein_Popup.SelectedRowIndex = 0
		    
		  Catch error As DatabaseException
		    MessageBox("Database Error: " + Str(db.ErrorCode) + EndOfLine + _
		    EndOfLine + db.ErrorMessage)
		  End Try
		  
		  //Populate Meal-2 Complex Carbs selections Popupmenu
		  Try 
		    db.Connect
		    
		    rs = db.SelectSQL("SELECT name FROM '"+app.foodsystem+"' WHERE gruppe = 'Complex' ORDER BY name ASC")
		    
		    meal2_complex_popup.RemoveAllRows
		    meal2_complex_popup.Addrow("Select")
		    While Not rs.AfterLastRow
		      meal2_complex_popup.AddRow(rs.Column("name").stringvalue)
		      rs.MoveToNextRow
		    Wend
		    rs.close
		    meal2_complex_popup.SelectedRowIndex = 0
		    
		  Catch error As DatabaseException
		    MessageBox("Database Error: " + Str(db.ErrorCode) + EndOfLine + _
		    EndOfLine + db.ErrorMessage)
		  End Try
		  
		  //Populate Meal-2 Extras Selections Popupmenu
		  Try 
		    db.Connect
		    
		    rs = db.SelectSQL("SELECT name FROM '"+app.foodsystem+"' WHERE gruppe = 'Extras' ORDER BY name ASC")
		    
		    meal2_extra_popup.RemoveAllRows
		    meal2_extra_popup.Addrow("Select")
		    While Not rs.AfterLastRow
		      meal2_extra_popup.AddRow(rs.Column("name").stringvalue)
		      rs.MoveToNextRow
		    Wend
		    rs.close
		    meal2_extra_popup.SelectedRowIndex = 0
		    
		  Catch error As DatabaseException
		    MessageBox("Database Error: " + Str(db.ErrorCode) + EndOfLine + _
		    EndOfLine + db.ErrorMessage)
		  End Try
		  
		  //Populate Meal-3 Greens Selections Popupmenu
		  Try 
		    db.Connect
		    
		    rs = db.SelectSQL("SELECT name FROM '"+app.foodsystem+"' WHERE gruppe = 'Greens' ORDER BY name ASC")
		    
		    meal3_greens_popup.RemoveAllRows
		    meal3_greens_popup.Addrow("Select")
		    While Not rs.AfterLastRow
		      meal3_greens_popup.AddRow(rs.Column("name").stringvalue)
		      rs.MoveToNextRow
		    Wend
		    rs.close
		    meal3_greens_popup.SelectedRowIndex = 0
		    
		  Catch error As DatabaseException
		    MessageBox("Database Error: " + Str(db.ErrorCode) + EndOfLine + _
		    EndOfLine + db.ErrorMessage)
		  End Try
		  
		  //Populate Meal-3 Fats, Legumes or Protein2 Selections Popupmenu
		  Try 
		    db.Connect
		    
		    
		    If system_select.SelectedIndex = 1 then //If System is Meal-3 then
		      If app.FoodSystem = "Foodbase" then //Vegan system
		        rs = db.SelectSQL("SELECT name FROM '"+app.foodsystem+"' WHERE gruppe = 'Legumes' ORDER BY name ASC")
		      ElseIf app.FoodSystem = "Foodbase1" Then //Standard system
		        rs = db.SelectSQL("SELECT name FROM '"+app.foodsystem+"' WHERE gruppe = 'Protein2' ORDER BY name ASC")
		      End If
		    Else //If not Meal-3 system
		      rs = db.SelectSQL("SELECT name FROM '"+app.foodsystem+"' WHERE gruppe = 'Fats' ORDER BY name ASC")
		    End If
		    
		    meal3_fats_popup.RemoveAllRows
		    meal3_fats_popup.Addrow("Select")
		    While Not rs.AfterLastRow
		      meal3_fats_popup.AddRow(rs.Column("name").stringvalue)
		      rs.MoveToNextRow
		    Wend
		    rs.close
		    meal3_fats_popup.SelectedRowIndex = 0
		    
		  Catch error As DatabaseException
		    MessageBox("Database Error: " + Str(db.ErrorCode) + EndOfLine + _
		    EndOfLine + db.ErrorMessage)
		  End Try
		  
		  //Populate Meal-4 Protein Selections Popupmenu
		  Try 
		    db.Connect
		    
		    //If Select second source of protein for the standard diet meal 4
		    If app.FoodSystem = "foodbase" then //Vegan
		      rs = db.SelectSQL("SELECT name FROM '"+app.foodsystem+"' WHERE gruppe = 'Protein' ORDER BY name ASC")
		    ElseIf app.FoodSystem = "foodbase1" Then //Standard
		      rs = db.SelectSQL("SELECT name FROM '"+app.foodsystem+"' WHERE gruppe = 'Protein2' ORDER BY name ASC")
		    End If
		    
		    meal4_protein_popup.RemoveAllRows
		    meal4_protein_popup.Addrow("Select")
		    While Not rs.AfterLastRow
		      meal4_protein_popup.AddRow(rs.Column("name").stringvalue)
		      rs.MoveToNextRow
		    Wend
		    rs.close
		    meal4_protein_popup.SelectedRowIndex = 0
		    
		  Catch error As DatabaseException
		    MessageBox("Database Error: " + Str(db.ErrorCode) + EndOfLine + _
		    EndOfLine + db.ErrorMessage)
		  End Try
		  
		  //Populate Meal-4 Extras Selections Popupmenu
		  Try 
		    db.Connect
		    
		    rs = db.SelectSQL("SELECT name FROM '"+app.foodsystem+"' WHERE gruppe = 'Extras' ORDER BY name ASC")
		    
		    meal4_extra_popup.RemoveAllRows
		    meal4_extra_popup.Addrow("Select")
		    While Not rs.AfterLastRow
		      meal4_extra_popup.AddRow(rs.Column("name").stringvalue)
		      rs.MoveToNextRow
		    Wend
		    rs.close
		    db.close //Close db after populating all food popupmenus
		    meal4_extra_popup.SelectedRowIndex = 0
		    
		  Catch error As DatabaseException
		    MessageBox("Database Error: " + Str(db.ErrorCode) + EndOfLine + _
		    EndOfLine + db.ErrorMessage)
		  End Try
		  
		  //Clear fields
		  meal1_ready.Text = ""
		  meal2_ready.Text = ""
		  meal3_ready.Text = ""
		  meal4_ready.Text = ""
		  
		  totals_m1.Text = ""
		  totals_m2.Text = ""
		  totals_m3.Text = ""
		  totals_m4.text = ""
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub Reset_calculations()
		  'Reset popups
		  meal1_simple_popup.SelectedRowIndex = 0
		  meal1_protein_popup.SelectedRowIndex = 0
		  meal2_complex_popup.SelectedRowIndex = 0
		  meal2_extra_popup.SelectedRowIndex = 0
		  meal3_greens_popup.SelectedRowIndex = 0
		  meal3_fats_popup.SelectedRowIndex = 0
		  meal4_protein_popup.SelectedRowIndex = 0
		  meal4_extra_popup.SelectedRowIndex = 0
		  
		  'Reset Total calculations
		  TotalKcal = 0
		  TotalProtein = 0
		  TotalCarb = 0
		  TotalFat = 0
		  
		  'Reset food data
		  Var i As Integer
		  For i = 0 To 3
		    meal1_data(i) = 0
		    meal1b_data(i) = 0
		    meal2_data(i) = 0
		    meal2b_data(i) = 0
		    meal3_data(i) = 0
		    meal3b_data(i) = 0
		    meal4_data(i) = 0
		    meal4b_data(i) = 0
		  Next
		  
		  M1_grams = 0
		  M1b_grams = 0
		  M2_grams = 0
		  M3_grams = 0
		  M3b_grams = 0
		  M4_grams = 0
		  
		  M1_kcal = 0
		  M1b_kcal = 0
		  M2_Kcal = 0
		  M3_Kcal = 0
		  M3b_Kcal = 0
		  M4_Kcal = 0
		  
		  meal = 0
		  kcaltotal = 0
		  selected_meal = 0
		  selectedfood = ""
		  
		  'Clear nutrients and total labels
		  totals_m1.Text = ""
		  totals_m2.Text = ""
		  totals_m3.Text = ""
		  totals_m4.Text = ""
		  totals_all.Text = ""
		  totals_all_percent.Text = ""
		  
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub Reset_verify()
		  
		  
		  'Reset Total calculations
		  TotalKcal = 0
		  TotalProtein = 0
		  TotalCarb = 0
		  TotalFat = 0
		  
		  'Reset food data
		  Var i As Integer
		  For i = 0 To 3
		    meal1_data(i) = 0
		    meal1b_data(i) = 0
		    meal2_data(i) = 0
		    meal2b_data(i) = 0
		    meal3_data(i) = 0
		    meal3b_data(i) = 0
		    meal4_data(i) = 0
		    meal4b_data(i) = 0
		  Next
		  
		  M1_grams = 0
		  M1b_grams = 0
		  M2_grams = 0
		  M3_grams = 0
		  M3b_grams = 0
		  M4_grams = 0
		  
		  M1_kcal = 0
		  M1b_kcal = 0
		  M2_Kcal = 0
		  M3_Kcal = 0
		  M3b_Kcal = 0
		  M4_Kcal = 0
		  
		  meal = 0
		  kcaltotal = 0
		  selected_meal = 0
		  selectedfood = ""
		  
		  'Clear nutrients and total labels
		  totals_m1.Text = ""
		  totals_m2.Text = ""
		  totals_m3.Text = ""
		  totals_m4.Text = ""
		  totals_all.Text = ""
		  totals_all_percent.Text = ""
		  
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub system_choice()
		  // Enable/disable selections based on Meal System 3,4,Simple
		  
		  If system_select.SelectedIndex = 0 Then 
		    'Simple
		    meal1_protein_popup.Enabled = False
		    meal1_protein_popup.Tooltip = ""
		    meal3_fats_popup.Enabled = False
		    meal3_fats_popup.Tooltip = ""
		    meal4_protein_popup.Enabled = False
		    meal4_protein_popup.Tooltip = ""
		    meal4_extra_popup.Enabled = False
		    meal4_extra_popup.Tooltip = ""
		    meal4_ready.Enabled = False
		    label6.Visible = False
		    Label10.visible = False
		    
		  ElseIf system_select.SelectedIndex = 1 Then
		    '3 Meals'
		    meal1_protein_popup.Enabled = True
		    meal1_protein_popup.Tooltip = "Proteins"
		    
		    meal3_fats_popup.Enabled = True
		    If app.FoodSystem = "Foodbase" then //Vegan
		      meal3_fats_popup.Tooltip = "Legumes"
		    Elseif app.FoodSystem = "Foodbase1" then //Standard
		      meal3_fats_popup.Tooltip = "Proteins"
		    End If
		    
		    meal4_protein_popup.Enabled = False
		    meal4_protein_popup.Tooltip = ""
		    meal4_extra_popup.Enabled = False
		    meal4_extra_popup.Tooltip = ""
		    meal4_ready.Enabled = False
		    Label6.Visible = False
		    Label10.visible = False
		    
		  ElseIf system_select.SelectedIndex = 2 Then
		    '4 Meals'
		    meal1_protein_popup.Enabled = True
		    meal1_protein_popup.Tooltip = "Proteins"
		    meal3_fats_popup.Enabled = True
		    meal3_fats_popup.Tooltip = "Fats"
		    meal4_protein_popup.Enabled = True
		    meal4_protein_popup.Tooltip = "Proteins"
		    meal4_extra_popup.Enabled = True
		    meal4_extra_popup.Tooltip = "Extras"
		    meal4_ready.Enabled = True
		    Label6.Visible = true
		    Label10.visible = True
		    
		  End If
		  
		  'repopulate foodpopups
		  Populate_selections
		  
		  
		  
		End Sub
	#tag EndMethod


	#tag Property, Flags = &h0
		activity_level As Integer
	#tag EndProperty

	#tag Property, Flags = &h0
		age As Integer
	#tag EndProperty

	#tag Property, Flags = &h0
		bodyfat As double
	#tag EndProperty

	#tag Property, Flags = &h0
		female As Boolean
	#tag EndProperty

	#tag Property, Flags = &h0
		foodgroup As string
	#tag EndProperty

	#tag Property, Flags = &h0
		height_a As Integer
	#tag EndProperty

	#tag Property, Flags = &h0
		height_b As Integer
	#tag EndProperty

	#tag Property, Flags = &h0
		kcaltotal As double
	#tag EndProperty

	#tag Property, Flags = &h0
		M1b_grams As Integer
	#tag EndProperty

	#tag Property, Flags = &h0
		M1b_kcal As Double
	#tag EndProperty

	#tag Property, Flags = &h0
		M1_grams As double
	#tag EndProperty

	#tag Property, Flags = &h0
		M1_kcal As Double
	#tag EndProperty

	#tag Property, Flags = &h0
		M2_grams As double
	#tag EndProperty

	#tag Property, Flags = &h0
		M2_Kcal As Double
	#tag EndProperty

	#tag Property, Flags = &h0
		M3b_grams As double
	#tag EndProperty

	#tag Property, Flags = &h0
		M3b_Kcal As Double
	#tag EndProperty

	#tag Property, Flags = &h0
		M3_grams As double
	#tag EndProperty

	#tag Property, Flags = &h0
		M3_Kcal As Double
	#tag EndProperty

	#tag Property, Flags = &h0
		M4_grams As double
	#tag EndProperty

	#tag Property, Flags = &h0
		M4_Kcal As Double
	#tag EndProperty

	#tag Property, Flags = &h0
		male As Boolean
	#tag EndProperty

	#tag Property, Flags = &h0
		meal As Integer
	#tag EndProperty

	#tag Property, Flags = &h0
		meal1b_data(3) As double
	#tag EndProperty

	#tag Property, Flags = &h0
		meal1_data(3) As double
	#tag EndProperty

	#tag Property, Flags = &h0
		meal2b_data(3) As double
	#tag EndProperty

	#tag Property, Flags = &h0
		meal2_data(3) As double
	#tag EndProperty

	#tag Property, Flags = &h0
		meal3b_data(3) As double
	#tag EndProperty

	#tag Property, Flags = &h0
		meal3_data(3) As double
	#tag EndProperty

	#tag Property, Flags = &h0
		meal4b_data(3) As double
	#tag EndProperty

	#tag Property, Flags = &h0
		meal4_data(3) As double
	#tag EndProperty

	#tag Property, Flags = &h0
		meal_mem(7) As Integer
	#tag EndProperty

	#tag Property, Flags = &h0
		NotebookText As string
	#tag EndProperty

	#tag Property, Flags = &h0
		Notestoclipboard As string
	#tag EndProperty

	#tag Property, Flags = &h0
		objective As Integer
	#tag EndProperty

	#tag Property, Flags = &h0
		selectedfood As string
	#tag EndProperty

	#tag Property, Flags = &h0
		selected_meal As Integer
	#tag EndProperty

	#tag Property, Flags = &h0
		TotalCarb As double
	#tag EndProperty

	#tag Property, Flags = &h0
		TotalFat As Double
	#tag EndProperty

	#tag Property, Flags = &h0
		TotalKcal As double
	#tag EndProperty

	#tag Property, Flags = &h0
		TotalProtein As double
	#tag EndProperty

	#tag Property, Flags = &h0
		userkcal As integer
	#tag EndProperty

	#tag Property, Flags = &h0
		us_metric As Boolean
	#tag EndProperty

	#tag Property, Flags = &h0
		weight As double
	#tag EndProperty


#tag EndWindowCode

#tag Events meal1_simple_popup
	#tag Event
		Sub SelectionChanged(item As DesktopMenuItem)
		  
		  Foodgroup = "Simple"
		  selectedfood = Me.SelectedRowValue
		  selected_meal = 1
		  
		  //In case a menu is set back to nothing 'index 0'
		  If me.SelectedRowIndex = 0 then
		    M1_grams = 0
		    meal1_data(0) = 0
		    meal1_data(1) = 0
		    meal1_data(2) = 0
		    meal1_data(3) = 0
		    M1_kcal = 0
		    totals_m1.text = ""
		    meal1_ready.text = "Select Simple Carb!"
		  End If
		  
		  //Clear display text before recalculating mealtotals
		  If me.SelectedRowIndex = 0 and meal1_protein_popup.SelectedRowIndex = 0 then
		    meal1_ready.text = ""
		    totals_all.text = ""
		    totals_all_percent.text = ""
		  End If
		  
		  If me.SelectedRowIndex > 0 and meal1_protein_popup.SelectedRowIndex = 0 then
		    meal1_ready.text = "Now select Protein!"
		  End If
		  
		  //Call methods
		  load_mealdata
		  calcmealdatatotals
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events meal1_protein_popup
	#tag Event
		Sub SelectionChanged(item As DesktopMenuItem)
		  Foodgroup = "Protein"
		  selectedfood = Me.SelectedRowValue
		  selected_meal = 1
		  
		  //In case a menu is set back to nothing 'index 0'
		  If me.SelectedRowIndex = 0 then
		    M1b_grams = 0
		    meal1b_data(0) = 0
		    meal1b_data(1) = 0
		    meal1b_data(2) = 0
		    meal1b_data(3) = 0
		    M1b_kcal = 0
		    totals_m1.text = ""
		    meal1_ready.text = "Select Protein!"
		  End If
		  
		  //Clear display text before recalculating mealtotals
		  If me.SelectedRowIndex = 0 and meal1_simple_popup.SelectedRowIndex = 0 then
		    meal1_ready.text = ""
		    totals_all.text = ""
		    totals_all_percent.text = ""
		  End If
		  
		  If me.SelectedRowIndex > 0 and meal1_simple_popup.SelectedRowIndex = 0 then
		    meal1_ready.text = "Select Simple Carb!"
		  End If
		  
		  //Call methods
		  load_mealdata
		  calcmealdatatotals
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events meal2_complex_popup
	#tag Event
		Sub SelectionChanged(item As DesktopMenuItem)
		  Foodgroup = "Complex"
		  selectedfood = Me.SelectedRowValue
		  selected_meal = 2
		  
		  //In case a menu is set back to nothing 'index 0'
		  If me.SelectedRowIndex = 0 then
		    M2_grams = 0
		    meal2_data(0) = 0
		    meal2_data(1) = 0
		    meal2_data(2) = 0
		    meal2_data(3) = 0
		    M2_kcal = 0
		    totals_m2.text = ""
		    meal2_ready.text = "Select Complex Carb!"
		    //else
		    //meal2_ready.text = ""
		  End If
		  
		  //Clear display text before recalculating mealtotals
		  If me.SelectedRowIndex = 0 and meal2_extra_popup.SelectedRowIndex = 0 then
		    meal2_ready.text = ""
		    totals_all.text = ""
		    totals_all_percent.text = ""
		  End If
		  
		  If me.SelectedRowIndex > 0 and meal2_extra_popup.SelectedRowIndex = 0 then
		    meal2_ready.text = "Now select Extra!"
		  End If
		  
		  //Call methods
		  load_mealdata
		  calcmealdatatotals
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events meal2_extra_popup
	#tag Event
		Sub SelectionChanged(item As DesktopMenuItem)
		  Foodgroup = "Extras"
		  selectedfood = Me.SelectedRowValue
		  selected_meal = 2
		  
		  //In case a menu is set back to nothing 'index 0'
		  If me.SelectedRowIndex = 0 then
		    meal2_ready.text = "Select Extra!"
		  End If
		  
		  //Clear display text before recalculating mealtotals
		  If me.SelectedRowIndex = 0 and meal2_complex_popup.SelectedRowIndex = 0 then
		    meal2_ready.text = ""
		    totals_all.text = ""
		    totals_all_percent.text = ""
		  End If
		  
		  If me.SelectedRowIndex > 0 and meal2_complex_popup.SelectedRowIndex = 0 then
		    meal2_ready.text = "Select Complex Carb!"
		  End If
		  
		  //Call methods
		  load_mealdata
		  calcmealdatatotals
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events meal3_greens_popup
	#tag Event
		Sub SelectionChanged(item As DesktopMenuItem)
		  Foodgroup = "Greens"
		  selectedfood = Me.SelectedRowValue
		  selected_meal = 3
		  
		  //In case a menu is set back to nothing 'index 0'
		  If me.SelectedRowIndex = 0 then
		    M3_grams = 0
		    meal3_data(0) = 0
		    meal3_data(1) = 0
		    meal3_data(2) = 0
		    meal3_data(3) = 0
		    M3_kcal = 0
		    totals_m3.text = ""
		    meal3_ready.text = "Select Green Carb!"
		  End If
		  
		  //Clear display text before recalculating mealtotals
		  If me.SelectedRowIndex = 0 and meal3_fats_popup.SelectedRowIndex = 0 then
		    meal3_ready.text = ""
		    totals_all.text = ""
		    totals_all_percent.text = ""
		  End If
		  If system_select.SelectedIndex = 2 then
		    If me.SelectedRowIndex > 0 and meal3_fats_popup.SelectedRowIndex = 0 then
		      meal3_ready.text = "Now select Fat!"
		    End If
		  elseif system_select.SelectedIndex = 1 then
		    If me.SelectedRowIndex > 0 and meal3_fats_popup.SelectedRowIndex = 0 then
		      If app.FoodSystem = "Foodbase" then //Vegan
		        meal3_ready.text = "Now select Legume!"
		      End If
		      If app.FoodSystem = "Foodbase1" then //Standard
		        meal3_ready.text = "Now select Protein!"
		      End If
		    End If
		  End If
		  
		  //Call methods
		  load_mealdata
		  calcmealdatatotals
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events meal3_fats_popup
	#tag Event
		Sub SelectionChanged(item As DesktopMenuItem)
		  //Decide which foodgroup based on Meal-system and Foodsystem
		  If system_select.SelectedIndex = 1 then
		    If app.FoodSystem = "Foodbase" then //vegan system
		      Foodgroup = "Legumes"
		    elseif app.FoodSystem = "Foodbase1" then //Standard system
		      Foodgroup = "Protein2"
		    End If
		  else //If not standard or Meal-3 system
		    Foodgroup = "Fats"
		  End If
		  selectedfood = Me.SelectedRowValue
		  selected_meal = 3
		  
		  //In case a menu is set back to nothing 'index 0'
		  If me.SelectedRowIndex = 0 then
		    M3b_grams = 0
		    meal3b_data(0) = 0
		    meal3b_data(1) = 0
		    meal3b_data(2) = 0
		    meal3b_data(3) = 0
		    M3b_kcal = 0
		    totals_m3.text = ""
		    If system_select.SelectedIndex = 1 then
		      meal3_ready.text = "Select Legumes"
		    else
		      meal3_ready.text = "Select Fat!"
		    End If
		  End If
		  
		  //Clear display text before recalculating mealtotals
		  If me.SelectedRowIndex = 0 and meal3_greens_popup.SelectedRowIndex = 0 then
		    meal3_ready.text = ""
		    totals_all.text = ""
		    totals_all_percent.text = ""
		  End If
		  
		  If me.SelectedRowIndex > 0 and meal3_greens_popup.SelectedRowIndex = 0 then
		    meal3_ready.text = "Select Green Carb!"
		  End If
		  
		  //Call methods
		  load_mealdata
		  calcmealdatatotals
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events kcal_enter
	#tag Event
		Sub TextChanged()
		  //Pass wished total calories to usercalories property
		  If me.Text <> "" and me.text.Tointeger >0 Then
		    userkcal = Integer.fromstring(me.Text) 
		  End If
		  
		  //Recalc mealdata totals
		  calcmealdatatotals
		End Sub
	#tag EndEvent
	#tag Event
		Sub FocusLost()
		  if me.text.ToInteger > 0 then
		    userkcal = Integer.fromstring(me.Text) 
		  else
		    MessageBox ("Please enter valid kcal!")
		    me.SetFocus
		  end if
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events Estimate_btn
	#tag Event
		Sub Pressed()
		  
		  Metabolism.Show
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events meal4_protein_popup
	#tag Event
		Sub SelectionChanged(item As DesktopMenuItem)
		  //If Select Second source of protein for the standard diet meal 4
		  If app.FoodSystem = "foodbase" then //Vegan
		    Foodgroup = "Protein"
		  elseif app.FoodSystem = "foodbase1" then //Standard
		    Foodgroup = "Protein2"
		  End If
		  
		  //Foodgroup = "Protein" (old)
		  
		  selectedfood = Me.SelectedRowValue
		  selected_meal = 4
		  
		  //In case a menu is set back to nothing 'index 0'
		  If me.SelectedRowIndex = 0 then
		    M4_grams = 0
		    meal4_data(0) = 0
		    meal4_data(1) = 0
		    meal4_data(2) = 0
		    meal4_data(3) = 0
		    M4_kcal = 0
		    totals_m4.text = ""
		    meal4_ready.text = "Select Protein!"
		  End If
		  
		  //Clear display text before recalculating mealtotals
		  If me.SelectedRowIndex = 0 and meal4_extra_popup.SelectedRowIndex = 0 then
		    meal4_ready.text = ""
		    totals_all.text = ""
		    totals_all_percent.text = ""
		  End If
		  
		  If me.SelectedRowIndex > 0 and meal4_extra_popup.SelectedRowIndex = 0 then
		    meal4_ready.text = "Now select Extra!"
		  End If
		  
		  //Call methods
		  load_mealdata
		  calcmealdatatotals
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events meal4_extra_popup
	#tag Event
		Sub SelectionChanged(item As DesktopMenuItem)
		  Foodgroup = "Extras"
		  selectedfood = Me.SelectedRowValue
		  selected_meal = 4
		  
		  //In case a menu is set back to nothing 'index 0'
		  If me.SelectedRowIndex = 0 then
		    meal4_ready.text = "Select Extra!"
		  End If
		  
		  //Clear display text before recalculating mealtotals
		  If me.SelectedRowIndex = 0 and meal4_protein_popup.SelectedRowIndex = 0 then
		    meal4_ready.text = ""
		    totals_all.text = ""
		    totals_all_percent.text = ""
		  End If
		  
		  If me.SelectedRowIndex > 0 and meal4_protein_popup.SelectedRowIndex = 0 then
		    meal4_ready.text = "Select Protein!"
		  End If
		  
		  //Call methods
		  load_mealdata
		  calcmealdatatotals
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events system_select
	#tag Event
		Sub SelectionChanged(button As DesktopRadioButton)
		  
		  //Call method to setup System
		  Macro_checkbox.value = False
		  Reset_calculations
		  system_choice
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events Label7
	#tag Event
		Function KeyDown(key As String) As Boolean
		  
		End Function
	#tag EndEvent
	#tag Event
		Function MouseDown(x As Integer, y As Integer) As Boolean
		  
		End Function
	#tag EndEvent
#tag EndEvents
#tag Events Macro_checkbox
	#tag Event
		Sub ValueChanged()
		  //View or hide macro labels
		  
		  If macro_checkbox.value = False Then
		    totals_m1.Visible = False
		    totals_m2.Visible = False
		    totals_m3.Visible = False
		    totals_m4.Visible = False
		    totals_all.Visible = False
		    totals_all_percent.Visible = False
		    label11.Visible = False
		  Else
		    totals_m1.Visible = True
		    totals_m2.Visible = True
		    totals_m3.Visible = True
		    totals_m4.Visible = True
		    totals_all.Visible = True
		    label11.Visible = True
		    totals_all_percent.Visible = true
		  End If
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events Copy_btn
	#tag Event
		Sub Pressed()
		  //Clear Notestoclipboard
		  Notestoclipboard = ""
		  
		  //Copy meals and and macro to Clipboard
		  If Macro_checkbox.value = True Then
		    Notestoclipboard = Totals_all.Text + Chr(13)
		    Notestoclipboard = Notestoclipboard + totals_all_percent.Text + Chr(13)+Chr(13)
		    
		    Notestoclipboard = Notestoclipboard + Label7.Text+ Chr(13)
		    Notestoclipboard = Notestoclipboard + meal1_ready.Text +Chr(13)+Chr(13)
		    
		    Notestoclipboard = Notestoclipboard + Label8.Text +Chr(13)
		    Notestoclipboard = Notestoclipboard + meal2_ready.Text +Chr(13)+Chr(13)
		    Notestoclipboard = Notestoclipboard + Label9.Text +Chr(13)
		    Notestoclipboard = Notestoclipboard + meal3_ready.Text +Chr(13)
		    If system_select.SelectedIndex > 1 Then
		      Notestoclipboard = Notestoclipboard + Chr(13)
		      Notestoclipboard = Notestoclipboard + Label10.Text +Chr(13)
		      Notestoclipboard = Notestoclipboard + meal4_ready.Text
		    End If
		    //Copy to Clipboard
		    Var c As New Clipboard
		    c.Text = Notestoclipboard
		    c.close
		  Else
		    //Macro not selected therefor not showing
		    Notestoclipboard = Notestoclipboard + Label7.Text + Chr(13)
		    Notestoclipboard = Notestoclipboard + meal1_ready.Text +Chr(13)+Chr(13)
		    Notestoclipboard = Notestoclipboard + Label8.Text +Chr(13)
		    Notestoclipboard = Notestoclipboard + meal2_ready.Text +Chr(13)+Chr(13)
		    Notestoclipboard = Notestoclipboard + Label9.Text +Chr(13)
		    Notestoclipboard = Notestoclipboard + meal3_ready.Text +Chr(13)
		    If system_select.SelectedIndex > 1 Then
		      Notestoclipboard = Notestoclipboard + Chr(13)
		      Notestoclipboard = Notestoclipboard + Label10.Text +Chr(13)
		      Notestoclipboard = Notestoclipboard + meal4_ready.Text
		    End If
		    //Copy to Clipboard
		    Var c As New Clipboard
		    c.Text = Notestoclipboard
		    c.close
		  End If
		  
		  //Open M4 notebook
		  'Notes_window.Show
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events LogMealplan_btn
	#tag Event
		Sub Pressed()
		  
		  //Verify that meals are created before proceeding to log
		  If system_select.SelectedIndex = 0 Then //Simple system
		    if meal1_ready.text ="" and meal2_ready.text ="" and meal3_ready.text = "" then
		      MessageBox("Nothing to log!")
		      Return
		    End If
		    //Verify individual meals are created
		    If meal1_simple_popup.SelectedRowIndex = 0 or meal2_complex_popup.SelectedRowIndex = 0_ 
		      or meal2_extra_popup.SelectedRowIndex = 0 or meal3_greens_popup.SelectedRowIndex = 0  then
		      MessageBox("Please check your meals!")
		      Return
		    End If
		    
		  Elseif system_select.SelectedIndex = 1 then //3-meal system
		    if meal1_ready.text ="" and meal2_ready.text ="" and meal3_ready.text = "" then
		      MessageBox("Nothing to log!")
		      Return
		    End If
		    //Verify individual meals are created
		    If meal1_simple_popup.SelectedRowIndex = 0 or meal1_protein_popup.SelectedRowIndex = 0_ 
		      or meal2_complex_popup.SelectedRowIndex = 0 or meal2_extra_popup.SelectedRowIndex = 0_
		      or meal3_greens_popup.SelectedRowIndex = 0 or meal3_fats_popup.SelectedRowIndex = 0 Then
		      MessageBox("Please check your meals!")
		      Return
		    End If
		    
		  ElseIf system_select.SelectedIndex = 2 Then //4-meal system
		    If meal1_ready.Text = "" and Meal2_ready.Text = ""_
		      and meal3_ready.Text = "" and meal4_ready.Text ="" Then
		      MessageBox("Nothing to log!")
		      Return
		    End If
		    //Verify individual meals are created
		    If meal1_simple_popup.SelectedRowIndex = 0 or meal1_protein_popup.SelectedRowIndex = 0_ 
		      or meal2_complex_popup.SelectedRowIndex = 0 or meal2_extra_popup.SelectedRowIndex = 0_
		      or meal3_greens_popup.SelectedRowIndex = 0 or meal3_fats_popup.SelectedRowIndex = 0_
		      or meal4_protein_popup.SelectedRowIndex = 0 or meal4_extra_popup.SelectedRowIndex = 0 Then
		      MessageBox("Please check your meals!")
		      Return
		    End If
		  End If
		  
		  //Clear and pass meal plan and data to Notestocliboard to store in DB
		  Notestoclipboard = ""
		  
		  Notestoclipboard = Totals_all.Text + Chr(13)
		  Notestoclipboard = Notestoclipboard + totals_all_percent.Text + Chr(13)+Chr(13)
		  
		  Notestoclipboard = Notestoclipboard + Label7.Text+ Chr(13)
		  Notestoclipboard = Notestoclipboard + meal1_ready.Text +Chr(13)+Chr(13)
		  Notestoclipboard = Notestoclipboard + Label8.Text +Chr(13)
		  Notestoclipboard = Notestoclipboard + meal2_ready.Text +Chr(13)+Chr(13)
		  Notestoclipboard = Notestoclipboard + Label9.Text +Chr(13)
		  Notestoclipboard = Notestoclipboard + meal3_ready.Text +Chr(13)
		  If system_select.SelectedIndex > 1 Then
		    Notestoclipboard = Notestoclipboard + Chr(13)
		    Notestoclipboard = Notestoclipboard + Label10.Text +Chr(13)
		    Notestoclipboard = Notestoclipboard + meal4_ready.Text
		  End If
		  
		  //Open window to enter date and store meal plan.
		  LogMealPlan.show
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events Clear_btn
	#tag Event
		Sub Pressed()
		  
		  //Clear fields
		  meal1_ready.Text = ""
		  meal2_ready.Text = ""
		  meal3_ready.Text = ""
		  meal4_ready.Text = ""
		  
		  totals_m1.Text = ""
		  totals_m2.Text = ""
		  totals_m3.Text = ""
		  totals_m4.text = ""
		  
		  //Call subroutines (methods)
		  Reset_calculations
		  system_choice
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events Button1
	#tag Event
		Sub Pressed()
		  foodlist.Show
		End Sub
	#tag EndEvent
#tag EndEvents
#tag ViewBehavior
	#tag ViewProperty
		Name="HasTitleBar"
		Visible=true
		Group="Frame"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Name"
		Visible=true
		Group="ID"
		InitialValue=""
		Type="String"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Interfaces"
		Visible=true
		Group="ID"
		InitialValue=""
		Type="String"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Super"
		Visible=true
		Group="ID"
		InitialValue=""
		Type="String"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Width"
		Visible=true
		Group="Size"
		InitialValue="600"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Height"
		Visible=true
		Group="Size"
		InitialValue="400"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="MinimumWidth"
		Visible=true
		Group="Size"
		InitialValue="64"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="MinimumHeight"
		Visible=true
		Group="Size"
		InitialValue="64"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="MaximumWidth"
		Visible=true
		Group="Size"
		InitialValue="32000"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="MaximumHeight"
		Visible=true
		Group="Size"
		InitialValue="32000"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Type"
		Visible=true
		Group="Frame"
		InitialValue="0"
		Type="Types"
		EditorType="Enum"
		#tag EnumValues
			"0 - Document"
			"1 - Movable Modal"
			"2 - Modal Dialog"
			"3 - Floating Window"
			"4 - Plain Box"
			"5 - Shadowed Box"
			"6 - Rounded Window"
			"7 - Global Floating Window"
			"8 - Sheet Window"
			"9 - Modeless Dialog"
		#tag EndEnumValues
	#tag EndViewProperty
	#tag ViewProperty
		Name="Title"
		Visible=true
		Group="Frame"
		InitialValue="Untitled"
		Type="String"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="HasCloseButton"
		Visible=true
		Group="Frame"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="HasMaximizeButton"
		Visible=true
		Group="Frame"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="HasMinimizeButton"
		Visible=true
		Group="Frame"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="HasFullScreenButton"
		Visible=true
		Group="Frame"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Resizeable"
		Visible=true
		Group="Frame"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Composite"
		Visible=false
		Group="OS X (Carbon)"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="MacProcID"
		Visible=false
		Group="OS X (Carbon)"
		InitialValue="0"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="FullScreen"
		Visible=true
		Group="Behavior"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="DefaultLocation"
		Visible=true
		Group="Behavior"
		InitialValue="2"
		Type="Locations"
		EditorType="Enum"
		#tag EnumValues
			"0 - Default"
			"1 - Parent Window"
			"2 - Main Screen"
			"3 - Parent Window Screen"
			"4 - Stagger"
		#tag EndEnumValues
	#tag EndViewProperty
	#tag ViewProperty
		Name="Visible"
		Visible=true
		Group="Behavior"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="ImplicitInstance"
		Visible=true
		Group="Window Behavior"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="HasBackgroundColor"
		Visible=true
		Group="Background"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="BackgroundColor"
		Visible=true
		Group="Background"
		InitialValue="&cFFFFFF"
		Type="ColorGroup"
		EditorType="ColorGroup"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Backdrop"
		Visible=true
		Group="Background"
		InitialValue=""
		Type="Picture"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="MenuBar"
		Visible=true
		Group="Menus"
		InitialValue=""
		Type="DesktopMenuBar"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="MenuBarVisible"
		Visible=true
		Group="Deprecated"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="kcaltotal"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="double"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="selectedfood"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="string"
		EditorType="MultiLineEditor"
	#tag EndViewProperty
	#tag ViewProperty
		Name="foodgroup"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="string"
		EditorType="MultiLineEditor"
	#tag EndViewProperty
	#tag ViewProperty
		Name="selected_meal"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="meal"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="userkcal"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="M1_kcal"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Double"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="M2_Kcal"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Double"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="M3_Kcal"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Double"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="M4_Kcal"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Double"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="M1b_kcal"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Double"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="M3b_Kcal"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Double"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="M1_grams"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="double"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="M1b_grams"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="M2_grams"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="double"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="M3_grams"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="double"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="M3b_grams"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="double"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="M4_grams"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="double"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="TotalKcal"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="double"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="TotalProtein"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="double"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="TotalCarb"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="double"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="TotalFat"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Double"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="NotebookText"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="string"
		EditorType="MultiLineEditor"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Notestoclipboard"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="string"
		EditorType="MultiLineEditor"
	#tag EndViewProperty
	#tag ViewProperty
		Name="age"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="height_a"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="height_b"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="weight"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="double"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="bodyfat"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="double"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="male"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="female"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="us_metric"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="activity_level"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="objective"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
#tag EndViewBehavior
